# Demo App for https://github.com/open-telemetry/opentelemetry-js-contrib/issues/2453

This app demonstrates two common occasions where `@opentelemetry/instrumentation-fs` creates an excessive amount of spans
during normal use.

## Example 1 - Excessive span creation due to `require()` calls

**How to run:**

- `npm ci`
- `npm run start:require-spam`

In this example we have a simple `express` "hello world" app, instrumented with 
`@opentelemetry/auto-instrumentations-node`'s `getNodeAutoInstrumentations()`. When starting the app we see 718 spans
generated by the `@opentelemetry/instrumentation-fs` package, which is mostly created by require calls. 

To see the output captured on my machine without having to run it yourself, see [require-spam-output.txt](./require-spam-output.txt)

## Example 2 - Error spans during normal operation

**How to run:**

- `npm ci`
- `npm run start:file-access-error`

In this example we have a simple app which uses the `fs` module to access a file that does not exist. A possible error
is handled in a catch block. This instrumented with `@opentelemetry/auto-instrumentations-node`'s
`getNodeAutoInstrumentations()`. When starting the app we see 20 spans generated by the
`@opentelemetry/instrumentation-fs` package, one of which is an error span, which may indicate to users that something
is wrong, even though reading a file and catching the error is a perfectly normal use of `fs.readFileSync`.

To see the output captured on my machine without having to run it yourself, see [file-access-error-output.txt](./file-access-error-output.txt)
